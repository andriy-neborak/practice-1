# üéÆ Four in a Row (STM32)

![Language](https://img.shields.io/badge/language-C-blue.svg)
![Platform](https://img.shields.io/badge/platform-STM32-green.svg)
![Architecture](https://img.shields.io/badge/architecture-Bare%20Metal-orange.svg)

–ù–∞–≤—á–∞–ª—å–Ω–∏–π –ø—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ª–æ–≥—ñ–∫–∏ –≥—Ä–∏ **"4 –≤ —Ä—è–¥"** –Ω–∞ –º—ñ–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ STM32. 

> ‚ö†Ô∏è **–û–Ω–æ–≤–ª–µ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏:** –ü—Ä–æ—î–∫—Ç –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–æ –∑ FreeRTOS –Ω–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä—É **Bare Metal** (–±–µ–∑ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏) –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó —à–≤–∏–¥–∫–æ–¥—ñ—ó, –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–æ—Å—Ç—ñ —Ç–∞ –ø—Ä—è–º–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ –∞–ø–∞—Ä–∞—Ç–Ω–∏–º–∏ —Ä–µ—Å—É—Ä—Å–∞–º–∏.

---

## ‚öôÔ∏è –¢–µ—Ö–Ω—ñ—á–Ω—ñ –≤–∏–º–æ–≥–∏ —Ç–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

### üî© –ê–ø–∞—Ä–∞—Ç–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è
* **Target Board:** STM32F0Discovery
* **MCU:** STM32F051R8 (ARM Cortex-M0)
* **Flash:** 64 KB | **RAM:** 8 KB
* **Interface:** UART (38400 baud, 8N1)

### üíª –ü—Ä–æ–≥—Ä–∞–º–Ω–µ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è
* **IDE:** STM32CubeIDE
* **Compiler:** GCC for ARM Embedded Processors (`arm-none-eabi`)
* **Debugger:** ST-LINK/V2

### üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
* **HAL Driver:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –Ω–∏–∑—å–∫–æ—Ä—ñ–≤–Ω–µ–≤–æ—ó —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø–µ—Ä–∏—Ñ–µ—Ä—ñ—ó.
* **Bare Metal:**
    * **Main Loop:** –û–±—Ä–æ–±–∫–∞ —ñ–≥—Ä–æ–≤–æ—ó –ª–æ–≥—ñ–∫–∏ —Ç–∞ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π.
    * **ISR (Interrupts):** –ö—Ä–∏—Ç–∏—á–Ω—ñ –∑–∞–¥–∞—á—ñ, —Ç–∞–∫—ñ —è–∫ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –ø—Ä–∏–π–æ–º –¥–∞–Ω–∏—Ö –ø–æ UART.
* **Timebase:** `SysTick` –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤—ñ–¥–ª—ñ–∫—É —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —á–∞—Å—É —Ç–∞ –æ–±—Ä–æ–±–∫–∏ —Ç–∞–π–º–∞—É—Ç—ñ–≤.

---

## üöÄ –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª

–ù–∞ –¥–∞–Ω–æ–º—É –µ—Ç–∞–ø—ñ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

- [x] **System:** –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–∞–∫—Ç—É–≤–∞–Ω–Ω—è (RCC) —Ç–∞ GPIO.
- [x] **UART Interrupts:** –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –ø—Ä–∏–π–æ–º –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è (non-blocking ring buffer).
- [x] **Protocol:** –í–ª–∞—Å–Ω–∏–π –±—ñ–Ω–∞—Ä–Ω–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º—ñ–Ω—É –¥–∞–Ω–∏–º–∏ (Command-based).
- [x] **Integrity:** –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ü—ñ–ª—ñ—Å–Ω–æ—Å—Ç—ñ –ø–∞–∫–µ—Ç—ñ–≤ —á–µ—Ä–µ–∑ CRC-8.
- [x] **Stability:** –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ —Ä–æ–∑—Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó (—Ç–∞–π–º–∞—É—Ç **10 –º—Å** –º—ñ–∂ –±–∞–π—Ç–∞–º–∏).
- [x] **Architecture:** –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –ø–∞—Ç–µ—Ä–Ω "Master-Slave" (–ü–ö ‚Äî Master, STM32 ‚Äî Slave).

---

## üì° –ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±–º—ñ–Ω—É (Binary Protocol)

–û–±–º—ñ–Ω –¥–∞–Ω–∏–º–∏ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –±—ñ–Ω–∞—Ä–Ω–∏–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—ó –¥–æ–≤–∂–∏–Ω–∏ **6 –±–∞–π—Ç**.

### üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç—É

| –ë–∞–π—Ç | –ù–∞–∑–≤–∞ | –û–ø–∏—Å |
| :---: | :--- | :--- |
| **0** | `CMD` | –ö–æ–º–∞–Ω–¥–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó (–Ω–∞–ø—Ä. `0x01` - —Ö—ñ–¥ –≥—Ä–∞–≤—Ü—è) |
| **1** | `ADDR_H` | –°—Ç–∞—Ä—à–∏–π –±–∞–π—Ç –∞–¥—Ä–µ—Å–∏ (–Ω–æ–º–µ—Ä –∫–æ–º—ñ—Ä–∫–∏) |
| **2** | `ADDR_L` | –ú–æ–ª–æ–¥—à–∏–π –±–∞–π—Ç –∞–¥—Ä–µ—Å–∏ |
| **3** | `DATA_H` | –°—Ç–∞—Ä—à–∏–π –±–∞–π—Ç –¥–∞–Ω–∏—Ö |
| **4** | `DATA_L` | –ú–æ–ª–æ–¥—à–∏–π –±–∞–π—Ç –¥–∞–Ω–∏—Ö |
| **5** | `CRC` | –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Å—É–º–∞ (Arithmetic Modulo 256) |

### üîê –ê–ª–≥–æ—Ä–∏—Ç–º —Ç–∞ –ë–µ–∑–ø–µ–∫–∞

#### 1. –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ CRC
–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞ —Å—É–º–∞ —Ä–æ–∑—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è —è–∫ —Å—É–º–∞ –ø–µ—Ä—à–∏—Ö 5 –±–∞–π—Ç –ø–∞–∫–µ—Ç—É:
```c
CRC = (CMD + ADDR_H + ADDR_L + DATA_H + DATA_L) & 0xFF
